# Описание репозитория

## Компоненты
В данном репозитории содержится несколько компонентов, к которым можно получить доступ:
- **Airflow** – оркестратор DAG'ов, доступен по порту `8080`. 
- **База данных** – хранит таблицы `stocks` и `tickers`, доступна по порту `5432`. 
- **Хранилище данных** – файлы выгружаются в `airflow/data_output`.

## Развертывание
Все компоненты разворачиваются с помощью `docker-compose`.

## Зависимости
В репозитории есть файл `requirements.txt`, который содержит список необходимых зависимостей для работы проекта.

## DAG'и
В репозитории определены три DAG'а:
1. **Заполнение таблицы stocks** – собирает и загружает данные в таблицу `stocks`.
2. **Заполнение таблицы tickers** – обновляет данные в таблице `tickers`.
3. **Создание CSV-файла** – выгружает данные в файл формата CSV в директорию `airflow/data_output`.

## Сбор данных
Для сбора данных используется API, а именно два запроса:
- [http://api.marketstack.com/v1/eod](http://api.marketstack.com/v1/tickers) для сбора названия тикеров.
- [http://api.marketstack.com/v1/eod](http://api.marketstack.com/v1/eod) для сбора данных по компаниям с параметрами: symbols - Имя в списке тикеров из первого запроса, date_from - начало сентября, date_to - конец сентября, limit на 10 записей 
- [http://api.marketstack.com/v1/eod](http://api.marketstack.com/v1/tickers) для сбора данных по тикерам.

## Аналитика данных
Для проверки качества данных в таблице `stocks` рекомендуется:
- Проверять поля на `NULL`-значения.
- Оценивать выбросы по отношению к медиане значений.

Самостоятельно проводить валидацию и прикрутить партиционироание я не успел доделать да и токены закончились уже на всех почтах...
В коде вложен мой Apikey, его хватит на один прогон
DAGи могут упасть в ошибку на стадии сбора данных, но это фиксится подменой ApiKey
